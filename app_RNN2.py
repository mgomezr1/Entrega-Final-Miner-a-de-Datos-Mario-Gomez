# -*- coding: utf-8 -*-
"""Despliegue_trabajo_final_red_neuronalV2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1u2nkZrsqDJnX4A3mgMwNZov7fLx-Hrim

# Despliegue

- Cargamos el modelo
- Cargamos los datos futuros
- Preparar los datos futuros
- Aplicamos el modelo para la predicci贸n
"""

# ============================================================
# UNIVERSIDAD PONTIFICIA BOLIVARIANA
# Proyecto Final - Miner铆a de Datos (CRISP-DM)
# App Streamlit - Despliegue Red Neuronal (Versi贸n final)
# ============================================================

import streamlit as st
import pandas as pd
import numpy as np
import pickle
import json
from pathlib import Path

# ------------------------------------------------------------
# CONFIGURACIN DE LA PGINA
# ------------------------------------------------------------
st.set_page_config(
    page_title="Predicci贸n de Riesgo de Hipertensi贸n Arterial",
    page_icon="┖",
    layout="wide"
)

# ------------------------------------------------------------
# ESTILOS VISUALES
# ------------------------------------------------------------
st.markdown("""
<style>
    .main { background-color: #F9FAFB; }
    h1, h2, h3 { color: #004b87 !important; font-weight: 700; }
    .stButton>button {
        background-color: #004b87; color: white; border-radius: 8px;
        height: 3em; width: 100%;
    }
    .stButton>button:hover { background-color: #FDB813; color: black; }
    footer {visibility: hidden;}
</style>
""", unsafe_allow_html=True)

# ------------------------------------------------------------
# ENCABEZADO
# ------------------------------------------------------------
col1, col2 = st.columns([1,4])
with col1:
    st.image("https://www.upb.edu.co/Style%20Library/UPB%20Theme/img/logo-upb.png", width=120)
with col2:
    st.title("Predicci贸n de Riesgo de Hipertensi贸n Arterial └")
    st.subheader("Proyecto Final - Metodolog铆a CRISP-DM")

st.markdown("---")

# ------------------------------------------------------------
# CARGA DEL MODELO
# ------------------------------------------------------------
@st.cache_resource
def cargar_modelo():
    filename = "modelo-class-RNN.pkl"
    with open(filename, "rb") as f:
        modelNN, labelencoder, variables, min_max_scaler = pickle.load(f)
    return modelNN, labelencoder, variables, min_max_scaler

try:
    modelNN, labelencoder, variables, min_max_scaler = cargar_modelo()
except Exception as e:
    st.error(f"锔 No se pudo cargar el modelo: {e}")
    st.stop()

# ------------------------------------------------------------
# ENTENDIMIENTO DEL NEGOCIO
# ------------------------------------------------------------
with st.expander(" Entendimiento del Negocio", expanded=True):
    st.write("""
    Este proyecto busca estimar el **riesgo de hipertensi贸n arterial** a partir de variables
    cl铆nicas, bioqu铆micas y antropom茅tricas, siguiendo la metodolog铆a **CRISP-DM**.
    """)

# ------------------------------------------------------------
# PREDICCIN EN TIEMPO REAL
# ------------------------------------------------------------
with st.expander(" Predicci贸n en tiempo real"):
    st.write("Ajusta los valores y ejecuta la predicci贸n.")

    c1, c2, c3 = st.columns(3)
    edad = c1.slider('edad', 9, 90, 30, 1)
    concentracion_hemoglobina = c2.slider('concentracion_hemoglobina', 8.0, 18.0, 13.5, 0.1)
    valor_colesterol_ldl = c3.slider('valor_colesterol_ldl', 2

"""# **Predicciones**
La calidad del modelo es:

- Exactirtud: 0.83
- Precisi贸n: 0.83
- Recall: 0.82
- Area ROC: 0.89
"""